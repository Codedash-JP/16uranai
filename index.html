<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>16 Personalities ç›¸æ€§ãƒŠãƒ“ï½œå…¨çµ„ã¿åˆã‚ã›ã‚¸ãƒ£ãƒ³ãƒ—</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
<header class="site-header">
  <div class="container">
    <h1>16 Personalities ç›¸æ€§ãƒŠãƒ“</h1>
    <p class="subtitle">å¥½ããª2ã‚¿ã‚¤ãƒ—ã‚’é¸ã¶ã ã‘ã€‚å…¨çµ„ã¿åˆã‚ã›ã®ç›¸æ€§ã‚’ã‚µã‚¯ãƒƒã¨ãƒã‚§ãƒƒã‚¯ï¼</p>
  </div>
</header>

<main class="container">
  <!-- Quick Picker -->
  <section class="card">
    <h2>ã™ãèª¿ã¹ã‚‹</h2>
    <div class="picker">
      <label>ã‚¿ã‚¤ãƒ—A
        <select id="typeA" aria-label="ã‚¿ã‚¤ãƒ—Aé¸æŠ"></select>
      </label>
      <span class="x">Ã—</span>
      <label>ã‚¿ã‚¤ãƒ—B
        <select id="typeB" aria-label="ã‚¿ã‚¤ãƒ—Bé¸æŠ"></select>
      </label>
      <button id="goBtn" class="btn">ç›¸æ€§ã‚’è¦‹ã‚‹</button>
    </div>
    <p class="note">ãƒ’ãƒ³ãƒˆï¼šURLã®æœ€å¾Œã« <code>#ENFP-INTJ</code> ã¿ãŸã„ã«å…¥ã‚Œã‚‹ã¨ã€ãã®ç›¸æ€§ã«ç›´æ¥ã¨ã¹ã‚‹ã‚ˆã€‚</p>
  </section>

  <!-- Matrix -->
  <section class="card" id="top">
    <h2>å…¨ã‚¿ã‚¤ãƒ—è¡¨ï¼ˆæŠ¼ã™ã¨ä¸‹ã«è§£èª¬ãŒå‡ºã‚‹ã‚ˆï¼‰</h2>
    <div class="matrix" role="table" aria-label="16 Personalities ç›¸æ€§è¡¨">
      <div class="matrix-row matrix-head" role="row">
        <div class="corner" role="columnheader" aria-label="corner"></div>
        <!-- column headers injected -->
      </div>
      <!-- rows injected -->
    </div>
    <details class="legend">
      <summary>è‰²ã®æ„å‘³</summary>
      <ul>
        <li><span class="chip chip-sim"></span> ã™ã”ãä¼¼ã¦ã‚‹ï¼ˆ3ã€œ4ã‚³ä¸€è‡´ï¼‰</li>
        <li><span class="chip chip-bal"></span> ã»ã©ã‚ˆãä¼¼ã¦ã‚‹ï¼ˆ2ã‚³ä¸€è‡´ï¼‰</li>
        <li><span class="chip chip-comp"></span> çœŸé€†ã£ã½ã„ã‘ã©è£œã„åˆãˆã‚‹ï¼ˆ0ã€œ1ã‚³ä¸€è‡´ï¼‰</li>
      </ul>
    </details>
  </section>

  <!-- Detail -->
  <section id="detail" class="card">
    <h2 id="pairTitle">ç›¸æ€§ã®è§£èª¬</h2>
    <div id="pairMeta" class="pair-meta"></div>
    <div id="analysis" class="analysis"></div>
    <div id="tips" class="tips"></div>

    <!-- ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³ -->
    <div id="shareArea" style="margin-top:20px;display:none;">
      <a id="twitterShare" target="_blank" rel="noopener" class="btn"
         style="background:#1DA1F2;box-shadow:0 4px 12px rgba(29,155,240,.3);">
        ğŸ¦ ã“ã®ç›¸æ€§ã‚’X(Twitter)ã§ã‚·ã‚§ã‚¢
      </a>
    </div>

    <div class="backlink">
      <a href="#top" aria-label="ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹">â†‘ ç›¸æ€§è¡¨ã«ã‚‚ã©ã‚‹</a>
    </div>
  </section>
</main>

<footer class="site-footer">
  <div class="container">
    <small>Â© 2025 16 Personalities ç›¸æ€§ãƒŠãƒ“ï¼ˆéå…¬å¼ãƒ»è‡ªå·±ç†è§£ã‚µãƒãƒ¼ãƒˆç”¨ï¼‰</small>
  </div>
</footer>

<script>
(function(){
  const TYPES = [
    "INTJ","INTP","ENTJ","ENTP",
    "INFJ","INFP","ENFJ","ENFP",
    "ISTJ","ISFJ","ESTJ","ESFJ",
    "ISTP","ISFP","ESTP","ESFP"
  ];

  // ã‚„ã•ã—ã‚è¡¨ç¾ç”¨
  const niceLabel = {
    EI: "å…ƒæ°—ã®å‘ãï¼ˆã²ã¨ã‚Šå¥½ã/ã¿ã‚“ãªå¥½ãï¼‰",
    SN: "æƒ…å ±ã®é›†ã‚æ–¹ï¼ˆäº‹å®Ÿé‡è¦–/ã²ã‚‰ã‚ãé‡è¦–ï¼‰",
    TF: "æ±ºã‚æ–¹ï¼ˆç†è©°ã‚/æ°—æŒã¡ï¼‰",
    JP: "äºˆå®šã®ç«‹ã¦æ–¹ï¼ˆãã£ã¡ã‚Š/ã‚†ã‚‹ã£ã¨ï¼‰"
  };

  const container = document.querySelector('.matrix');
  const headRow = container.querySelector('.matrix-head');
  const typeA = document.getElementById('typeA');
  const typeB = document.getElementById('typeB');
  const goBtn = document.getElementById('goBtn');

  // ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ä½œæˆ
  TYPES.forEach(t => {
    typeA.append(new Option(t, t));
    typeB.append(new Option(t, t));
  });
  typeA.value = "ENFP";
  typeB.value = "INTJ";

  // ã‚¯ãƒªãƒƒã‚¯ã§ãƒãƒƒã‚·ãƒ¥æ›´æ–°ï¼‹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
  goBtn.addEventListener('click', () => {
    location.hash = `${typeA.value}-${typeB.value}`;
  });

  // ãƒ˜ãƒƒãƒ€ãƒ¼ç”Ÿæˆ
  const headFrag = document.createDocumentFragment();
  TYPES.forEach(t => {
    const d = document.createElement('div');
    d.className = 'matrix-headcell';
    d.setAttribute('role','columnheader');
    d.innerHTML = `<span class="type">${t}</span>`;
    headFrag.appendChild(d);
  });
  headRow.appendChild(headFrag);

  // ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  const matchCount = (a,b) => [...a].filter((ch,i) => ch===b[i]).length;
  const levelClass = (a,b) => matchCount(a,b)>=3 ? 'cell-sim' : matchCount(a,b)===2 ? 'cell-bal' : 'cell-comp';
  const linkFor = (a,b) => `#${a}-${b}`;

  // è¡Œç”Ÿæˆ
  TYPES.forEach(rowType => {
    const row = document.createElement('div');
    row.className = 'matrix-row';
    row.setAttribute('role','row');

    const head = document.createElement('div');
    head.className = 'matrix-sidehead';
    head.setAttribute('role','rowheader');
    head.innerHTML = `<span class="type">${rowType}</span>`;
    row.appendChild(head);

    TYPES.forEach(colType => {
      const cell = document.createElement('a');
      cell.href = linkFor(rowType, colType);
      cell.className = `matrix-cell ${levelClass(rowType,colType)}`;
      cell.setAttribute('role','cell');
      cell.setAttribute('aria-label', `${rowType} Ã— ${colType} ã®ç›¸æ€§ã‚’è¦‹ã‚‹`);
      cell.textContent = "â—";
      // ã‚¯ãƒªãƒƒã‚¯æ™‚ã«ä¸‹ã®è§£èª¬ã¸ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
      cell.addEventListener('click', () => {
        // ãƒãƒƒã‚·ãƒ¥é·ç§»å¾Œã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆå°‘ã—é…ã‚‰ã›ã‚‹ï¼‰
        setTimeout(() => {
          document.getElementById('detail').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }, 10);
      });
      row.appendChild(cell);
    });
    container.appendChild(row);
  });

  const pairTitle = document.getElementById('pairTitle');
  const pairMeta = document.getElementById('pairMeta');
  const analysis = document.getElementById('analysis');
  const tips = document.getElementById('tips');
  const shareArea = document.getElementById('shareArea');
  const twitterShare = document.getElementById('twitterShare');

  // ã‚„ã•ã—ã„è¦ç´„ãƒ†ã‚­ã‚¹ãƒˆ
  function dimensionLine(a,b,idx, themeKey){
    const same = a[idx] === b[idx];
    if (themeKey==="EI") return same
      ? `${niceLabel.EI}ãŒä¼¼ã¦ã‚‹ã‹ã‚‰ã€ä¸€ç·’ã«éã”ã™ãƒšãƒ¼ã‚¹ã‚’åˆã‚ã›ã‚„ã™ã„ã‚ˆã€‚`
      : `${niceLabel.EI}ãŒé•ã†ã‹ã‚‰ã€ã²ã¨ã‚Šæ™‚é–“ã¨ã¿ã‚“ãªæ™‚é–“ã®ãƒãƒ©ãƒ³ã‚¹ç›¸è«‡ãŒã‚«ã‚®ï¼`;
    if (themeKey==="SN") return same
      ? `${niceLabel.SN}ãŒä¼¼ã¦ã¦è©±ãŒæ—©ã„ã€‚æƒ…å ±ã®é›†ã‚æ–¹ã‚‚ãƒ†ãƒ³ãƒåˆã†ã€‚`
      : `${niceLabel.SN}ãŒé•ã†ã‹ã‚‰ã€äº‹å®Ÿæ´¾ã¨ã²ã‚‰ã‚ãæ´¾ã§å½¹å‰²åˆ†æ‹…ãŒâ—`;
    if (themeKey==="TF") return same
      ? `${niceLabel.TF}ãŒä¼¼ã¦ã¦æ±ºã‚ã‚‹ã®æ—©ã„ã€‚ãŸã ã—åå¯¾æ„è¦‹ã®ãƒã‚§ãƒƒã‚¯å½¹ã‚‚ç½®ã“ã†ã€‚`
      : `${niceLabel.TF}ãŒé•ã†ã‹ã‚‰ã€ã€Œäº‹å®Ÿâ†’æ°—æŒã¡ã€ã®é †ã§è©±ã™ã¨ã‚±ãƒ³ã‚«é˜²æ­¢ã€‚`;
    // JP
    return same
      ? `${niceLabel.JP}ãŒä¼¼ã¦ã‚‹ã‹ã‚‰ã€äºˆå®šã®ç«‹ã¦æ–¹ã§ã‚¹ãƒˆãƒ¬ã‚¹å°‘ãªã‚ã€‚`
      : `${niceLabel.JP}ãŒé•ã†ã‹ã‚‰ã€ç· åˆ‡ã¯ã€Œç¢ºå®šã€ã¨ã€Œæ¢ç´¢ã€ã§2æœ¬ç«‹ã¦ã«ã—ã‚ˆã€‚`;
  }

  const tagFor = (a,b) => {
    const m = matchCount(a,b);
    if (a===b) return "åŒã˜ã‚¿ã‚¤ãƒ—ï¼šè¶…ã‚¹ãƒ ãƒ¼ã‚ºã€‚ã ã‘ã©åŒã˜å¼±ç‚¹ã‚‚å…±æœ‰ã—ãŒã¡ã€‚";
    if (m>=3) return "ã‹ãªã‚Šä¼¼ã¦ã‚‹ï¼šå®‰å¿ƒæ„Ÿã¤ã‚ˆã‚ã€‚ãƒ†ãƒ³ãƒåˆã†ã€‚";
    if (m===2) return "åŠåˆ†ä¼¼ã¦ã‚‹ï¼šãƒãƒ©ãƒ³ã‚¹è‰¯ãé€²ã‚ã‚„ã™ã„ã€‚";
    return "ã‘ã£ã“ã†é•ã†ï¼šãƒãƒã‚‹ã¨æœ€å¼·ã€‚é•ã„ãŒæ­¦å™¨ï¼";
  };

  function microTips(a,b){
    const tips = [];
    if (a[0]!==b[0]) tips.push("é€±ã®äºˆå®šã«â€œã²ã¨ã‚Šæ™‚é–“/ã¿ã‚“ãªæ™‚é–“â€ã‚’å…¥ã‚Œã¦ãŠãã€‚");
    else tips.push("ä¼‘ã¿æ–¹ãŒä¼¼ã¦ã‚‹ã‹ã‚‰ã€åŒã˜ãƒªã‚ºãƒ ã§OKã€‚");
    if (a[1]!==b[1]) tips.push("è©±ã—æ–¹ã¯ã€Œçµè«–â†’æ ¹æ‹ ã€ï¼ˆäº‹å®Ÿæ´¾ï¼‰ã‹ã€Œä»®èª¬â†’å¯èƒ½æ€§ã€ï¼ˆã²ã‚‰ã‚ãæ´¾ï¼‰ã‹å…ˆã«å…±æœ‰ã€‚");
    else tips.push("åŒã˜æ–¹å‘ã§æƒ…å ±é›†ã‚ã§ãã‚‹ã‹ã‚‰ã€é‡è¤‡ã«æ³¨æ„ã—ã¦åˆ†æ‹…ã€‚");
    if (a[2]!==b[2]) tips.push("æ±ºã‚ã”ã¨ã¯â€œäº‹å®Ÿã®è¡¨â€â†’â€œæ°—æŒã¡ã®è¡¨â€ã§ãƒã‚§ãƒƒã‚¯ã€‚");
    else tips.push("åˆæ„ãŒæ—©ã„ã¶ã‚“ã€ç¬¬ä¸‰è€…ã®æ„è¦‹ã‚‚ä¸€å›é€šã™ã€‚");
    if (a[3]!==b[3]) tips.push("ç· åˆ‡ã¯ã€Œã“ã“ã¾ã§ã«æ±ºã‚ã‚‹ã€ã¨ã€Œã“ã“ã¾ã§æ¢ã™ã€ã‚’åˆ†ã‘ã‚‹ã€‚");
    else tips.push("åŒã˜ãƒšãƒ¼ã‚¹ã€‚ç„¡ç†ã—ã™ãã‚µã‚¤ãƒ³ã ã‘æ±ºã‚ã¦ãŠã“ã†ã€‚");
    return tips;
  }

  function renderPair(hash){
    const m = (hash||"").replace(/^#/, "").toUpperCase();
    if (!/^[EI][NS][TF][JP]-[EI][NS][TF][JP]$/.test(m)) {
      pairTitle.textContent = "ç›¸æ€§ã®è§£èª¬";
      pairMeta.innerHTML = "<p>ä¸Šã®è¡¨ã‚„ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ã‹ã‚‰ã‚¿ã‚¤ãƒ—ã‚’é¸ã‚“ã§ã­ã€‚</p>";
      analysis.innerHTML = "";
      tips.innerHTML = "";
      shareArea.style.display = "none";
      return;
    }
    const [A,B] = m.split("-");
    pairTitle.textContent = `${A} Ã— ${B} ã®ç›¸æ€§`;
    const tag = tagFor(A,B);

    const dims = [
      dimensionLine(A,B,0,"EI"),
      dimensionLine(A,B,1,"SN"),
      dimensionLine(A,B,2,"TF"),
      dimensionLine(A,B,3,"JP")
    ];

    pairMeta.innerHTML = `
      <div class="pair-chip">${A}</div>
      <div class="pair-chip">Ã—</div>
      <div class="pair-chip">${B}</div>
      <div class="pair-tag">${tag}</div>
      <div class="pair-score">ä¸€è‡´ï¼š${matchCount(A,B)}/4</div>
    `;

    analysis.innerHTML = `
      <h3>ã©ã‚“ãªæ„Ÿã˜ï¼Ÿ</h3>
      <ul class="bullets">
        ${dims.map(d => `<li>${d}</li>`).join("")}
      </ul>
      <p class="disclaimer">â€» ã“ã‚Œã¯ã‚¿ã‚¤ãƒ—ã®å‚¾å‘ã‚’ã‚†ã‚‹ã£ã¨ã¾ã¨ã‚ãŸç›®å®‰ã ã‚ˆã€‚äººã«ã‚ˆã£ã¦é•ã„ã¯ã‚ã‚Šã¾ã™ã€‚</p>
    `;

    tips.innerHTML = `
      <h3>ã†ã¾ãã„ãã‚³ãƒ„</h3>
      <ol class="tips-list">
        ${microTips(A,B).map(t => `<li>${t}</li>`).join("")}
      </ol>
    `;

    // ã‚·ã‚§ã‚¢è¨­å®šï¼ˆã€Œ16 Personalitiesã€ã§çµ±ä¸€ï¼‰
    const pageUrl = location.href.split("#")[0] + `#${A}-${B}`;
    const tweetText = encodeURIComponent(`16 Personalitiesç›¸æ€§ï¼š${A} Ã— ${B} ã¯ã€Œ${tag}ã€ã ã£ãŸã‚ˆï¼`);
    const tweetUrl = `https://twitter.com/intent/tweet?text=${tweetText}&url=${encodeURIComponent(pageUrl)}&hashtags=16Personalities,ç›¸æ€§`;
    twitterShare.href = tweetUrl;
    shareArea.style.display = "block";

    // è¡¨ã‹ã‚‰æ¥ã¦ã‚‚ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‹ã‚‰æ¥ã¦ã‚‚ä¸‹ã¸ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
    requestAnimationFrame(() => {
      document.getElementById('detail').scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  }

  // ãƒãƒƒã‚·ãƒ¥å¤‰åŒ–ã§æç”»
  window.addEventListener('hashchange', () => renderPair(location.hash));
  if (!location.hash) location.hash = "top";
  renderPair(location.hash);
})();
</script>
</body>
</html>
